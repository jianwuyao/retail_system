<template>  <div>    <div class="page-view">      <div class="table-operations">        <a-space>          <a-button @click="handleBatchDelete">批量删除</a-button>        </a-space>      </div>      <a-table        size="middle"        rowKey="id"        :loading="data.loading"        :columns="columns"        :data-source="data.orderList"        :scroll="{ x: 'max-content' }"        :row-selection="rowSelection"        :pagination="{          size: 'default',          current: data.page,          pageSize: data.pageSize,          onChange: (current) => (data.page = current),          showSizeChanger: false,          showTotal: (total) => `共 ${total} 条数据`,        }"      >        <template #bodyCell="{ text, record, index, column }">          <template v-if="column.key === 'orderDetails'">            <a-button @click="handleOrderDetails(record)">查看商品列表</a-button>          </template>          <template v-if="column.key === 'status'">            <a-tag :color="text === '1' ? '#2db7f5' : text === '2' ? '#87d068' : '#f00'">              {{ text === '1' ? '待支付' : text === '2' ? '已支付' : '已取消' }}            </a-tag>          </template>          <template v-if="column.key === 'operation'">            <span>              <a-popconfirm title="确定取消?" ok-text="是" cancel-text="否" @confirm="confirmCancel(record)">                <a>取消</a>              </a-popconfirm>              <a-divider type="vertical" />              <a-popconfirm title="确定删除?" ok-text="是" cancel-text="否" @confirm="confirmDelete(record)">                <a>删除</a>              </a-popconfirm>              <a-divider type="vertical" />              <a-button @click="handleAddress(record)">查看收货信息</a-button>            </span>          </template>        </template>      </a-table>    </div>  </div>  <!--查看商品列表-->  <div>    <a-modal :visible="modal.visible_things" :forceRender="true" :title="modal.title" footer="" @cancel="handleCancel">      <div class="things-item" v-for="item in modal.thingsData">        <div class="infos">          <span class="title">{{ item.title }}</span>          <span class="price" style="color: #ff7b31">￥{{ item.price }}</span>          <span class="number">X{{ item.number }}</span>        </div>      </div>    </a-modal>  </div>  <!--查看地址-->  <div>    <a-modal :visible="modal.visible_address" :forceRender="true" :title="modal.title" footer="" @cancel="handleCancel">      <div class="address-item">        <div class="name-box">          <span class="name">收货人：{{ modal.receiverName }}</span>          <span class="mobile">电话：{{ modal.receiverPhone }}</span>        </div>        <div class="address-box">          <span class="address">地址：{{ modal.receiverAddress }}</span>        </div>      </div>    </a-modal>  </div></template><script setup lang="ts">  import { message } from 'ant-design-vue';  import { listApi, deleteApi, cancelApi } from '/@/api/order';  const columns = reactive([    {      title: '序号',      dataIndex: 'index',      key: 'index',      align: 'center',    },    {      title: '用户',      dataIndex: 'userName',      key: 'userName',      align: 'center',    },    {      title: '商品列表',      dataIndex: 'orderDetails',      key: 'orderDetails',    },    {      title: '状态',      dataIndex: 'status',      key: 'status',      align: 'center',      scopedSlots: { customRender: 'status' },    },    {      title: '下单时间',      dataIndex: 'orderTime',      key: 'orderTime',      align: 'center',    },    {      title: '结算时间',      dataIndex: 'payTime',      key: 'payTime',      align: 'center',    },    {      title: '操作',      dataIndex: 'action',      key: 'operation',      align: 'center',      fixed: 'right',      width: 300,    },  ]);  // 页面数据  const data = reactive({    orderList: [],    loading: false,    keyword: '',    selectedRowKeys: [] as any[],    pageSize: 10,    page: 1,  });  // 弹窗数据  const modal = reactive({    visible_address: false,    visible_things: false,    title: '',    thingsData: [],    receiverName: undefined,    receiverPhone: undefined,    receiverAddress: undefined,  });  onMounted(() => {    getDataList();  });  const getDataList = () => {    data.loading = true;    listApi()      .then((res) => {        data.loading = false;        res.data.forEach((item: any, index: any) => {          item.index = index + 1;        });        data.orderList = res.data;      })      .catch((err) => {        data.loading = false;        console.log(err.msg);      });  };  const rowSelection = ref({    onChange: (selectedRowKeys: (string | number)[], selectedRows: DataItem[]) => {      console.log(`selectedRowKeys: ${selectedRowKeys}`, 'selectedRows: ', selectedRows);      data.selectedRowKeys = selectedRowKeys;    },  });  const confirmCancel = (record: any) => {    cancelApi({ id: record.id })      .then((res) => {        getDataList();        message.success('取消成功');      })      .catch((err) => {        message.error(err.msg || '操作失败');      });  };  const confirmDelete = (record: any) => {    if (record.status === '1') {      message.warn('该订单未支付，请先取消！');      return;    }    deleteApi({ ids: record.id })      .then((res) => {        getDataList();      })      .catch((err) => {        message.error(err.msg || '操作失败');      });  };  const handleBatchDelete = () => {    if (data.selectedRowKeys.length <= 0) {      message.warn('请勾选删除项');      return;    }    deleteApi({ ids: data.selectedRowKeys.join(',') })      .then((res) => {        message.success('删除成功');        data.selectedRowKeys = [];        getDataList();      })      .catch((err) => {        message.error(err.msg || '操作失败');      });  };  const handleOrderDetails = (record) => {    modal.visible_things = true;    modal.title = '查看商品列表';    modal.thingsData = record.orderDetails;  };  const handleAddress = (record) => {    modal.visible_address = true;    modal.title = '查看收货信息';    modal.receiverName = record.receiverName;    modal.receiverPhone = record.receiverPhone;    modal.receiverAddress = record.receiverAddress;  };  const handleCancel = () => {    modal.visible_things = false;    modal.visible_address = false;  };</script><style scoped lang="less">  .page-view {    min-height: 100%;    background: #fff;    padding: 24px;    display: flex;    flex-direction: column;  }  .table-operations {    margin-bottom: 16px;    text-align: right;  }  .table-operations > button {    margin-right: 8px;  }  .address-item {    background: #f7f9fb;    border-radius: 4px;    margin-bottom: 12px;    -webkit-box-pack: justify;    -ms-flex-pack: justify;    justify-content: space-between;    padding: 16px;    .name-box {      color: #152844;      font-size: 18px;      line-height: 22px;      height: 22px;      .name {        margin-right: 20px;      }    }    .address-box {      color: #484848;      font-size: 18px;      line-height: 22px;      height: 22px;      margin-top: 15px;    }  }  .things-item {    background: #f7f9fb;    border-radius: 4px;    margin-bottom: 12px;    -webkit-box-pack: justify;    -ms-flex-pack: justify;    justify-content: space-between;    padding: 16px;    .infos {      color: #152844;      font-size: 18px;      line-height: 22px;      height: 22px;      .title {        margin-right: 20px;      }      .number {        float: right;        width: 30px;      }    }  }</style>